{
    "name": "Envato Toolkit",
    "slug": "toolkit-for-envato",
    "version": "1.4",
    "author": "<a href=\"https://profiles.wordpress.org/KestutisIT\">KestutisIT</a>",
    "author_profile": "https://profiles.wordpress.org/kestutisit/",
    "contributors": {
        "kestutisit": {
            "profile": "https://profiles.wordpress.org/kestutisit/",
            "avatar": "https://secure.gravatar.com/avatar/4daa5cd2999e5929e650ec79344c9320?s=96&d=monsterid&r=g",
            "display_name": "KestutisIT"
        }
    },
    "requires": "4.6",
    "tested": "5.7.12",
    "requires_php": "5.4",
    "requires_plugins": [],
    "compatibility": [],
    "rating": 56,
    "ratings": {
        "5": 3,
        "4": 1,
        "3": 0,
        "2": 1,
        "1": 4
    },
    "num_ratings": 9,
    "support_url": "https://wordpress.org/support/plugin/toolkit-for-envato/",
    "support_threads": 0,
    "support_threads_resolved": 0,
    "active_installs": 9000,
    "downloaded": 122279,
    "last_updated": "2021-04-26 18:00:00",
    "added": "2017-06-21",
    "homepage": "https://wordpress.org/plugins/toolkit-for-envato/",
    "sections": {
        "description": "<p>It is a 3 files library + Visual UI, to validate the purchase codes of your customers, get details about specific Envato user (country, city, total followers, total sales, avatar), get his license purchase and support expiration dates, license type he bought, check for updates of purchased plugins and themes and get the download links for them.</p>\n<p>Plus &#8211; this library has Envato Item Id search feature by providing plugin&#8217;s or theme&#8217;s name and author. So &#8211; yes, this is a tool you, as a developer / author, have been looking for months.</p>\n<p>If you are looking for the library-only version to integrate into your plugin / theme, it&#8217;s on GitHub:<br />\n<a href=\"https://github.com/KestutisIT/EnvatoToolkit\" title=\"Envato Toolkit (Standalone)\" rel=\"nofollow ugc\">Envato Toolkit (Standalone)</a></p>\n<p>The main purpose of this plugin is to help you to start much easier without having a headache trying to understand <code>WordPress - Envato Market</code> plugins code, that is the only one built by Envato, and has so complicated and unclear code, that you never get how it works (see example below).</p>\n<p>When I tried to create plugin&#8217;s <code>[Check for Update]</code> and <code>[Validate Purchase Code]</code> feature-buttons in the plugin myself, and I saw the code of the <code>WordPress - Envato Market</code> plugin, I was shocked how badly it is written and how you should not to code.</p>\n<p>For example &#8211; you would like to give an error message, if Envato user token is empty, which is a required string, i.e. &#8211; <code>pAA0aBCdeFGhiJKlmNOpqRStuVWxyZ44</code>. If you like K.I.S.S., PSR-2, D.R.Y., clean code coding standards and paradigms, you&#8217;d probably just have these five lines of code, so that every developer would get it:</p>\n<pre><code>$token = get_user_meta(get_current_user_id(), 'envato_token', TRUE);\nif($token == \"\")\n{\n    return new \\WP_Error('api_token_error', __('An API token is required.', 'envato-toolkit'));\n}\n</code></pre>\n<p>Now lets see how the same task traceback looks like in <code>WordPress - Envato Market</code> plugin:</p>\n<ol>\n<li>\n<p><code>[Api.php -&gt; request(..)]</code> Check if the token is empty:</p>\n<pre><code>if ( empty( $token ) )\n{\n    return new WP_Error( 'api_token_error', __( 'An API token is required.', 'envato-market' ) );\n}\n</code></pre>\n</li>\n<li>\n<p><code>[Api.php -&gt; request(..)]</code> Parse it from another string:</p>\n<pre><code>$token = trim( str_replace( 'Bearer', '', $args['headers']['Authorization'] ) );\n</code></pre>\n</li>\n<li>\n<p><code>[Api.php -&gt; request(..)]</code> Parse it one more time &#8211; this time from arguments array:</p>\n<pre><code>public function request( $url, $args = array() ) {\n    $defaults = array(\n        'timeout' =&gt; 20,\n    );\n    $args = wp_parse_args( $args, $defaults );\n}\n</code></pre>\n</li>\n<li>\n<p><code>[Api.php -&gt; download(..)]</code> Transfer the token variable one more time &#8211; this time via params:</p>\n<pre><code>class Envato_Market_API {\n    public function download( $id, $args = array() ) {\n        $url = 'https://api.envato.com/v2/market/buyer/download?item_id=' . $id . '&amp;shorten_url=true';\n        return $this-&gt;request( $url, $args );\n    }\n}\n</code></pre>\n</li>\n<li>\n<p><code>[admin.php -&gt; maybe_deferred_download(..)]</code> Pass it again &#8211; this time get it to args array from another method call:</p>\n<pre><code>function maybe_deferred_download( $options ) {\n    $args = $this-&gt;set_bearer_args();\n    $options['package'] = envato_market()-&gt;api()-&gt;download( $vars['item_id'], $args );\n    return $options;\n}\n</code></pre>\n</li>\n<li>\n<p><code>[admin.php -&gt; set_bearer_args(..)]</code> Wrap the token into multi-dimensional string array:</p>\n<pre><code>$args = array(\n    'headers' =&gt; array(\n        'Authorization' =&gt; 'Bearer ' . $token,\n    ),\n);\n</code></pre>\n</li>\n<li>\n<p><code>[admin.php -&gt; set_bearer_args(..)]</code> Pass the wrapped token one more time &#8211; this time get it from get_option:</p>\n<pre><code>foreach ( envato_market()-&gt;get_option( 'items', array() ) as $item ) {\n    if ( $item['id'] === $id ) {\n        $token = $item['token'];\n        break;\n    }\n}\n</code></pre>\n</li>\n<li>\n<p><code>[admin.php -&gt; get_option(..)]</code> So what&#8217;s in this <code>get_option</code>? &#8211; Correct, another call to another method &#8211; <code>get_options()</code>:</p>\n<pre><code>public function get_option( $name, $default = '' ) {\n    $options = self::get_options();\n    $name = self::sanitize_key( $name );\n    return isset( $options[ $name ] ) ? $options[ $name ] : $default;\n}\n</code></pre>\n</li>\n<li>\n<p><code>[admin.php -&gt; get_options()]</code> Finally, after almost 10 steps in the tree, we are finally getting the original<br />\nWordPress method call, but now I&#8217;m getting confused again &#8211; what is that <code>option_name</code> variable here:</p>\n<pre><code>public function get_options() {\n    return get_option( $this-&gt;option_name, array() );\n}\n</code></pre>\n</li>\n<li>\n<p><code>[envato-market.php -&gt; init_globals()]</code> Here is it is &#8211; the <code>option name</code> key name is&#8230; Oh wait&#8230;<br />\nNo it is not here it. It is equals to another variable, who is is put<br />\nin another clean-up function &#8211; look like I&#8217;m keep seeing this for the 2 time in the tree &#8211; the sanitization of sanitization:</p>\n<pre><code>$this-&gt;option_name = self::sanitize_key( $this-&gt;slug );\n</code></pre>\n</li>\n<li>\n<p><code>[envato-market.php -&gt; init_globals()]</code> So the <code>option name</code> key name is the name of <code>$this-&gt;slug</code>.<br />\nNow lets see what is the value of <code>$this-&gt;slug</code>:</p>\n<pre><code>$this-&gt;slug        = 'envato-market';\n</code></pre>\n</li>\n</ol>\n<p>So it takes <strong>eleven (!)</strong> steps to understand one variable. And the whole code of that plugin is like that. The example above was the headache I had, until I realized that I must write a new Envato API Management Toolkit, instead of trying to use what Envato is giving, because otherwise I won&#8217;t get anything working ever.</p>\n<p>And, I believe, that many other developers had the same issue when tried to create update check feature for their plugins or themes.</p>\n<p>So instead of using that library for myself, I decided that I want to help all these developers to save their time, and I&#8217;m sharing this code with you. I&#8217;m releasing it under MIT license, which allows you to use this code in your plugin without any restrictions for both &#8211; free and commercial use.</p>\n<p>Plus &#8211; I&#8217;m giving a promise to you, that this plugin is and will always be 100% free, without any ads, &#8216;Subscribe&#8217;, &#8216;Follow us&#8217;, &#8216;Check our page&#8217;, &#8216;Get Pro Version&#8217; or similar links.</p>\n<p>If you created in hi-quality code a valuable additional functionality to the library and you want to share it with everyone &#8211; I&#8217;m open here to support your efforts, and add your code to the plugin&#8217;s library, so that we all together make this plugin better for authors &#8211; the better is the plugin, the better plugins authors will make for their customers. The better quality products we will have on the internet, the happier people will be all over the world.</p>\n<p>Finally &#8211; the code is poetry &#8211; <strong>the better is the plugin, the happier is the world</strong>.</p>\n<p>The pseudo-code of example output of the plugin is this:</p>\n<pre><code>Details about you:\n----------------------------------------------------------\nList of all different plugins you bought:\n&lt;?php foreach($plugins AS $pluginId =&gt; $plugin): ?&gt;\n    &lt;?='Plugin Id: '.$pluginId.', Name: '.$plugin['name'];?&gt;, Licenses:\n    &lt;?php foreach($plugin['licenses'] AS $license): ?&gt;\n        Code: &lt;?=$license['purchase_code'];?&gt;,\n        License: &lt;?=$license['license'];?&gt;,\n        Purchased: &lt;?=$license['license_purchase_date'];?&gt; &lt;?=$license['license_purchase_time'];?&gt;,\n        Expires: &lt;?=$license['support_expiration_date'];?&gt; &lt;?=$license['support_expiration_time'];?&gt;,\n        Support Status: &lt;?=$license['support_active'];?&gt;\n    &lt;?php endforeach; ?&gt;\n&lt;?php endforeach; ?&gt;\n\nList of all different themes you bought:\n&lt;?php foreach($themes AS $themeId =&gt; $theme): ?&gt;\n    &lt;?='Theme Id: '.$themeId.', Name: '.$theme['name'];?&gt;, Licenses:\n    &lt;?php foreach($theme['licenses'] AS $license): ?&gt;\n        Code: &lt;?=$license['purchase_code'];?&gt;,\n        License: &lt;?=$license['license'];?&gt;,\n        Purchased: &lt;?=$license['license_purchase_date'];?&gt; &lt;?=$license['license_purchase_time'];?&gt;,\n        Expires: &lt;?=$license['support_expiration_date'];?&gt; &lt;?=$license['support_expiration_time'];?&gt;,\n        Status: &lt;?=$license['support_active'] == 1 ? \"Supported\" : \"Support Expired\";?&gt;\n    &lt;?php endforeach; ?&gt;\n&lt;?php endforeach; ?&gt;\n\nYour summary:\nYour location is &lt;?=$authorCity;?&gt;, &lt;?=$authorCountry;?&gt;.\nYou&#039;ve sold your items &lt;?=$authorSales;?&gt; times and you have &lt;?=$authorFollowers;?&gt; followers on Envato.\n\n1. Your Customer&#039;s License Details\n----------------------------------------------------------\nPurchase Code: &lt;?=$targetPurchaseCode;?&gt;\nIs Valid License: &lt;?=$isValidTargetLicense ? 'Yes' : 'No';?&gt;\nBuyer Username: &lt;?=$targetLicenseBuyer;?&gt;\nLicense Type: &lt;?=$targetLicenseType;?&gt;\nPurchased At: &lt;?=$targetLicensePurchasedAt;?&gt;\nSupported Until: &lt;?=$targetLicenseSupportedUntil;?&gt;\nSupport Status: &lt;?=$targetLicenseSupportActive == 1 ? \"Supported\" : \"Support Expired\";?&gt;\n\n2. Details About Target Envato User - &lt;?=$targetUsername;?&gt;\n----------------------------------------------------------\n&lt;?=$targetUsername;?&gt; is located in &lt;?=$targetUserCity;?&gt;, &lt;?=$targetUserCountry;?&gt;.\nHe sold his items &lt;?=$targetUserSales;?&gt; times and has &lt;?=$targetUserFollowers;?&gt; followers on Envato.\n\n3. Status of Purchased Plugin ID - &lt;?=$targetPluginId;?&gt;\n----------------------------------------------------------\nPlugin Name: &lt;?=$nameOfTargetPluginId;?&gt;\nPlugin Update Available: &lt;?=$pluginUpdateAvailable ? 'Yes' : 'No';?&gt;\nInstalled Plugin Version: &lt;?=$installedPluginVersion;?&gt;\nAvailable Plugin Version: &lt;?=$availablePluginVersion;?&gt;\nPlugin Update Download URL:\n&lt;a href=\"&lt;?=$pluginUpdateDownloadUrl;?&gt;\" target=\"_blank\" title=\"Download newest version\"&gt;Download newest version&lt;/a&gt;\n\n4. Status of Purchased Theme ID - &lt;?=$targetThemeId;?&gt;:\n----------------------------------------------------------\nTheme Name: &lt;?=$nameOfTargetThemeId;?&gt;\nTheme Update Available: &lt;?=$themeUpdateAvailable ? 'Yes' : 'No';?&gt;\nInstalled Theme Version: &lt;?=$installedThemeVersion;?&gt;\nAvailable Theme Version: &lt;?=$availableThemeVersion;?&gt;\nTheme Update Download URL:\n&lt;a href=\"&lt;?=$themeUpdateDownloadUrl;?&gt;\" target=\"_blank\" title=\"Download newest version\"&gt;Download newest version&lt;/a&gt;\n\n5. Envato Item Id of Purchased Plugin\n----------------------------------------------------------\nSearched for Name: &lt;?=$targetPluginName;?&gt;\nSearched for Author: &lt;?=$targetPluginAuthor;?&gt;\nFound Plugin Id: &lt;?=$foundPluginId;?&gt;\n\n6. Envato Item Id of Purchased Theme\n----------------------------------------------------------\nSearched for Name: &lt;?=$targetThemeName;?&gt;\nSearched for Author: &lt;?=$targetThemeAuthor;?&gt;\nFound Theme Id: &lt;?=$foundThemeId;?&gt;\n</code></pre>\n<p>And the example input of the output above, it this:</p>\n<pre><code>$objToolkit = new EnvatoAPIManager($toolkitSettings);\n\n// Details about you\n$purchasedPlugins = $objToolkit-&gt;getPurchasedPluginsWithDetails();\n$plugins = array();\nforeach($purchasedPlugins AS $pluginId =&gt; $purchasedPlugin)\n{\n    $purchasedPlugin['licenses'] = $objToolkit-&gt;getLicensesByItemId($pluginId);\n    $plugins[$pluginId] = $purchasedPlugin;\n}\n\n$purchasedThemes = $objToolkit-&gt;getPurchasedThemesWithDetails();\n$themes = array();\nforeach($purchasedThemes AS $themeId =&gt; $purchasedTheme)\n{\n    $purchasedTheme['licenses'] = $objToolkit-&gt;getLicensesByItemId($themeId);\n    $themes[$themeId] = $purchasedTheme;\n}\n\n$authorDetails = $objToolkit-&gt;getUserDetails($sanitizedEnvatoUsername);\n// View vars\n$view-&gt;plugins = $plugins;\n$view-&gt;themes = $themes;\nif($authorDetails != FALSE)\n{\n    $view-&gt;authorCity = $authorDetails['city'];\n    $view-&gt;authorCountry = $authorDetails['country'];\n    $view-&gt;authorSales = $authorDetails['sales'];\n    $view-&gt;authorFollowers = $authorDetails['followers'];\n} else\n{\n    $view-&gt;authorCity = '';\n    $view-&gt;authorCountry = '';\n    $view-&gt;authorSales = 0;\n    $view-&gt;authorFollowers = 0;\n}\n\n// 1. Details About Target Purchase Code\n$targetLicenseDetails = $objToolkit-&gt;getLicenseDetails($sanitizedTargetPurchaseCode);\n// View vars\n$view-&gt;targetPurchaseCode = esc_html($sanitizedTargetPurchaseCode); // Ready for print\n$view-&gt;isValidTargetLicense = $objToolkit-&gt;isValidLicense($sanitizedTargetPurchaseCode);\n$view-&gt;targetLicenseBuyer = $targetLicenseDetails['buyer_username'];\n$view-&gt;targetLicense = $targetLicenseDetails['license'];\n$view-&gt;targetLicensePurchasedAt = $targetLicenseDetails['license_purchase_date'].' '.$targetLicenseDetails['license_purchase_time'];\n$view-&gt;targetLicenseSupportedUntil = $targetLicenseDetails['support_expiration_date'].' '.$targetLicenseDetails['support_expiration_time'];\n$view-&gt;targetLicenseSupportActive = $targetLicenseDetails['support_active'];\n\n// 2. Details About Target Envato User\n$targetUserDetails = $objToolkit-&gt;getUserDetails($sanitizedTargetUsername);\n// View vars\n$view-&gt;targetUsername = esc_html($sanitizedTargetUsername); // Ready for print\n$view-&gt;targetUserCity = $targetUserDetails['city'];\n$view-&gt;targetUserCountry = $targetUserDetails['country'];\n$view-&gt;targetUserSales = $targetUserDetails['sales'];\n$view-&gt;targetUserFollowers = $targetUserDetails['followers'];\n\n// 3. Status of Purchased Plugin ID\n$availablePluginVersion = $objToolkit-&gt;getAvailableVersion($sanitizedTargetPluginId);\n$pluginUpdateAvailable = version_compare($sanitizedInstalledPluginVersion, $availablePluginVersion, '&lt;');\n// View vars\n$view-&gt;targetPluginId = intval($sanitizedTargetPluginId); // Ready for print\n$view-&gt;installedPluginVersion = esc_html($sanitizedInstalledPluginVersion); // Ready for print\n$view-&gt;nameOfTargetPluginId = esc_html($objToolkit-&gt;getItemName($sanitizedTargetPluginId));\n$view-&gt;availablePluginVersion = $availablePluginVersion;\n$view-&gt;pluginUpdateAvailable = $pluginUpdateAvailable;\n$view-&gt;pluginUpdateDownloadUrl = $pluginUpdateAvailable ? $objToolkit-&gt;getDownloadUrlIfPurchased($sanitizedTargetPluginId) : '';\n\n// 4. Status of Purchased Theme ID\n$availableThemeVersion = $objToolkit-&gt;getAvailableVersion($sanitizedTargetThemeId);\n$themeUpdateAvailable = version_compare($sanitizedInstalledThemeVersion, $availableThemeVersion, '&lt;');\n// View vars\n$view-&gt;targetThemeId = intval($sanitizedTargetThemeId); // Ready for print\n$view-&gt;installedThemeVersion = esc_html($sanitizedInstalledThemeVersion); // Ready for print\n$view-&gt;nameOfTargetThemeId = esc_html($objToolkit-&gt;getItemName($sanitizedTargetThemeId));\n$view-&gt;availableThemeVersion = $availableThemeVersion;\n$view-&gt;themeUpdateAvailable = $themeUpdateAvailable;\n$view-&gt;themeUpdateDownloadUrl = $themeUpdateAvailable ? $objToolkit-&gt;getDownloadUrlIfPurchased($sanitizedTargetThemeId) : '';\n\n// 5. Envato Item Id of Purchased Plugin\n$view-&gt;targetPluginName = esc_html($sanitizedTargetPluginName); // Ready for print\n$view-&gt;targetPluginAuthor = esc_html($sanitizedTargetPluginAuthor); // Ready for print\n$view-&gt;foundPluginId = $objToolkit-&gt;getItemIdByPluginAndAuthorIfPurchased($sanitizedTargetPluginName, $sanitizedTargetPluginAuthor);\n\n// 6. Envato Item Id of Purchased Theme\n$view-&gt;targetThemeName = esc_html($sanitizedTargetThemeName); // Ready for print\n$view-&gt;targetThemeAuthor = esc_html($sanitizedTargetThemeAuthor); // Ready for print\n$view-&gt;foundThemeId = $objToolkit-&gt;getItemIdByThemeAndAuthorIfPurchased($sanitizedTargetThemeName, $sanitizedTargetThemeAuthor);\n</code></pre>\n",
        "installation": "<p>This section describes how to install the plugin and get it working.</p>\n<ol>\n<li>Upload <code>EnvatoToolkit</code> (or <code>toolkit-for-envato</code>) to the <code>/wp-content/plugins/</code> directory.</li>\n<li>Activate the plugin through the &#8216;Plugins&#8217; menu in WordPress.</li>\n<li>Go to admin menu item <code>EnvatoToolkit</code> and enter your Envato Username, Envato API Key and Envato Private Token.</li>\n<li>That&#8217;s it.</li>\n</ol>\n",
        "faq": "\n<dt id='how%20does%20it%20work%3F'>\nHow does it work?\n</h4>\n<p>\n<p>This plugin uses both &#8211; Envato Edge API and Envato Market API to retrieve required data automatically, without any need of server-in-the-middle.<br />\nSo there is no need to save your head revision number or last version on your server, it will get that that automatically from Envato via it&#8217;s API.</p>\n</p>\n\n",
        "changelog": "<h4>1.4</h4>\n<ul>\n<li>Improved debugging.</li>\n</ul>\n<h4>1.3</h4>\n<ul>\n<li>Added support for purchase time and license expiration time. Plus split to two fields on &#8216;license_type&#8217; to &#8216;license&#8217; and &#8216;license_type&#8217;.</li>\n</ul>\n<h4>1.2</h4>\n<ul>\n<li>Added support for the situations if Envato API is down, plus added detailed error message handler.</li>\n</ul>\n<h4>1.1</h4>\n<ul>\n<li>Removed 1 redundant API class method that should be handled by the controller, not a model. Plus, for security reasons, changelog.txt is no more in the plugin folder (so that there would be no way to discover the actual plugin version by public.</li>\n</ul>\n<h4>1.0</h4>\n<ul>\n<li>Initial release!</li>\n</ul>\n"
    },
    "short_description": "Validate purchase code, check for item update &amp; support expiration, download newest version, lookup for user details, search for Envato item id &amp; more",
    "description": "<p>It is a 3 files library + Visual UI, to validate the purchase codes of your customers, get details about specific Envato user (country, city, total followers, total sales, avatar), get his license purchase and support expiration dates, license type he bought, check for updates of purchased plugins and themes and get the download links for them.</p>\n<p>Plus &#8211; this library has Envato Item Id search feature by providing plugin&#8217;s or theme&#8217;s name and author. So &#8211; yes, this is a tool you, as a developer / author, have been looking for months.</p>\n<p>If you are looking for the library-only version to integrate into your plugin / theme, it&#8217;s on GitHub:<br />\n<a href=\"https://github.com/KestutisIT/EnvatoToolkit\" title=\"Envato Toolkit (Standalone)\" rel=\"nofollow ugc\">Envato Toolkit (Standalone)</a></p>\n<p>The main purpose of this plugin is to help you to start much easier without having a headache trying to understand <code>WordPress - Envato Market</code> plugins code, that is the only one built by Envato, and has so complicated and unclear code, that you never get how it works (see example below).</p>\n<p>When I tried to create plugin&#8217;s <code>[Check for Update]</code> and <code>[Validate Purchase Code]</code> feature-buttons in the plugin myself, and I saw the code of the <code>WordPress - Envato Market</code> plugin, I was shocked how badly it is written and how you should not to code.</p>\n<p>For example &#8211; you would like to give an error message, if Envato user token is empty, which is a required string, i.e. &#8211; <code>pAA0aBCdeFGhiJKlmNOpqRStuVWxyZ44</code>. If you like K.I.S.S., PSR-2, D.R.Y., clean code coding standards and paradigms, you&#8217;d probably just have these five lines of code, so that every developer would get it:</p>\n<pre><code>$token = get_user_meta(get_current_user_id(), 'envato_token', TRUE);\nif($token == \"\")\n{\n    return new \\WP_Error('api_token_error', __('An API token is required.', 'envato-toolkit'));\n}\n</code></pre>\n<p>Now lets see how the same task traceback looks like in <code>WordPress - Envato Market</code> plugin:</p>\n<ol>\n<li>\n<p><code>[Api.php -&gt; request(..)]</code> Check if the token is empty:</p>\n<pre><code>if ( empty( $token ) )\n{\n    return new WP_Error( 'api_token_error', __( 'An API token is required.', 'envato-market' ) );\n}\n</code></pre>\n</li>\n<li>\n<p><code>[Api.php -&gt; request(..)]</code> Parse it from another string:</p>\n<pre><code>$token = trim( str_replace( 'Bearer', '', $args['headers']['Authorization'] ) );\n</code></pre>\n</li>\n<li>\n<p><code>[Api.php -&gt; request(..)]</code> Parse it one more time &#8211; this time from arguments array:</p>\n<pre><code>public function request( $url, $args = array() ) {\n    $defaults = array(\n        'timeout' =&gt; 20,\n    );\n    $args = wp_parse_args( $args, $defaults );\n}\n</code></pre>\n</li>\n<li>\n<p><code>[Api.php -&gt; download(..)]</code> Transfer the token variable one more time &#8211; this time via params:</p>\n<pre><code>class Envato_Market_API {\n    public function download( $id, $args = array() ) {\n        $url = 'https://api.envato.com/v2/market/buyer/download?item_id=' . $id . '&amp;shorten_url=true';\n        return $this-&gt;request( $url, $args );\n    }\n}\n</code></pre>\n</li>\n<li>\n<p><code>[admin.php -&gt; maybe_deferred_download(..)]</code> Pass it again &#8211; this time get it to args array from another method call:</p>\n<pre><code>function maybe_deferred_download( $options ) {\n    $args = $this-&gt;set_bearer_args();\n    $options['package'] = envato_market()-&gt;api()-&gt;download( $vars['item_id'], $args );\n    return $options;\n}\n</code></pre>\n</li>\n<li>\n<p><code>[admin.php -&gt; set_bearer_args(..)]</code> Wrap the token into multi-dimensional string array:</p>\n<pre><code>$args = array(\n    'headers' =&gt; array(\n        'Authorization' =&gt; 'Bearer ' . $token,\n    ),\n);\n</code></pre>\n</li>\n<li>\n<p><code>[admin.php -&gt; set_bearer_args(..)]</code> Pass the wrapped token one more time &#8211; this time get it from get_option:</p>\n<pre><code>foreach ( envato_market()-&gt;get_option( 'items', array() ) as $item ) {\n    if ( $item['id'] === $id ) {\n        $token = $item['token'];\n        break;\n    }\n}\n</code></pre>\n</li>\n<li>\n<p><code>[admin.php -&gt; get_option(..)]</code> So what&#8217;s in this <code>get_option</code>? &#8211; Correct, another call to another method &#8211; <code>get_options()</code>:</p>\n<pre><code>public function get_option( $name, $default = '' ) {\n    $options = self::get_options();\n    $name = self::sanitize_key( $name );\n    return isset( $options[ $name ] ) ? $options[ $name ] : $default;\n}\n</code></pre>\n</li>\n<li>\n<p><code>[admin.php -&gt; get_options()]</code> Finally, after almost 10 steps in the tree, we are finally getting the original<br />\nWordPress method call, but now I&#8217;m getting confused again &#8211; what is that <code>option_name</code> variable here:</p>\n<pre><code>public function get_options() {\n    return get_option( $this-&gt;option_name, array() );\n}\n</code></pre>\n</li>\n<li>\n<p><code>[envato-market.php -&gt; init_globals()]</code> Here is it is &#8211; the <code>option name</code> key name is&#8230; Oh wait&#8230;<br />\nNo it is not here it. It is equals to another variable, who is is put<br />\nin another clean-up function &#8211; look like I&#8217;m keep seeing this for the 2 time in the tree &#8211; the sanitization of sanitization:</p>\n<pre><code>$this-&gt;option_name = self::sanitize_key( $this-&gt;slug );\n</code></pre>\n</li>\n<li>\n<p><code>[envato-market.php -&gt; init_globals()]</code> So the <code>option name</code> key name is the name of <code>$this-&gt;slug</code>.<br />\nNow lets see what is the value of <code>$this-&gt;slug</code>:</p>\n<pre><code>$this-&gt;slug        = 'envato-market';\n</code></pre>\n</li>\n</ol>\n<p>So it takes <strong>eleven (!)</strong> steps to understand one variable. And the whole code of that plugin is like that. The example above was the headache I had, until I realized that I must write a new Envato API Management Toolkit, instead of trying to use what Envato is giving, because otherwise I won&#8217;t get anything working ever.</p>\n<p>And, I believe, that many other developers had the same issue when tried to create update check feature for their plugins or themes.</p>\n<p>So instead of using that library for myself, I decided that I want to help all these developers to save their time, and I&#8217;m sharing this code with you. I&#8217;m releasing it under MIT license, which allows you to use this code in your plugin without any restrictions for both &#8211; free and commercial use.</p>\n<p>Plus &#8211; I&#8217;m giving a promise to you, that this plugin is and will always be 100% free, without any ads, &#8216;Subscribe&#8217;, &#8216;Follow us&#8217;, &#8216;Check our page&#8217;, &#8216;Get Pro Version&#8217; or similar links.</p>\n<p>If you created in hi-quality code a valuable additional functionality to the library and you want to share it with everyone &#8211; I&#8217;m open here to support your efforts, and add your code to the plugin&#8217;s library, so that we all together make this plugin better for authors &#8211; the better is the plugin, the better plugins authors will make for their customers. The better quality products we will have on the internet, the happier people will be all over the world.</p>\n<p>Finally &#8211; the code is poetry &#8211; <strong>the better is the plugin, the happier is the world</strong>.</p>\n<p>The pseudo-code of example output of the plugin is this:</p>\n<pre><code>Details about you:\n----------------------------------------------------------\nList of all different plugins you bought:\n&lt;?php foreach($plugins AS $pluginId =&gt; $plugin): ?&gt;\n    &lt;?='Plugin Id: '.$pluginId.', Name: '.$plugin['name'];?&gt;, Licenses:\n    &lt;?php foreach($plugin['licenses'] AS $license): ?&gt;\n        Code: &lt;?=$license['purchase_code'];?&gt;,\n        License: &lt;?=$license['license'];?&gt;,\n        Purchased: &lt;?=$license['license_purchase_date'];?&gt; &lt;?=$license['license_purchase_time'];?&gt;,\n        Expires: &lt;?=$license['support_expiration_date'];?&gt; &lt;?=$license['support_expiration_time'];?&gt;,\n        Support Status: &lt;?=$license['support_active'];?&gt;\n    &lt;?php endforeach; ?&gt;\n&lt;?php endforeach; ?&gt;\n\nList of all different themes you bought:\n&lt;?php foreach($themes AS $themeId =&gt; $theme): ?&gt;\n    &lt;?='Theme Id: '.$themeId.', Name: '.$theme['name'];?&gt;, Licenses:\n    &lt;?php foreach($theme['licenses'] AS $license): ?&gt;\n        Code: &lt;?=$license['purchase_code'];?&gt;,\n        License: &lt;?=$license['license'];?&gt;,\n        Purchased: &lt;?=$license['license_purchase_date'];?&gt; &lt;?=$license['license_purchase_time'];?&gt;,\n        Expires: &lt;?=$license['support_expiration_date'];?&gt; &lt;?=$license['support_expiration_time'];?&gt;,\n        Status: &lt;?=$license['support_active'] == 1 ? \"Supported\" : \"Support Expired\";?&gt;\n    &lt;?php endforeach; ?&gt;\n&lt;?php endforeach; ?&gt;\n\nYour summary:\nYour location is &lt;?=$authorCity;?&gt;, &lt;?=$authorCountry;?&gt;.\nYou&#039;ve sold your items &lt;?=$authorSales;?&gt; times and you have &lt;?=$authorFollowers;?&gt; followers on Envato.\n\n1. Your Customer&#039;s License Details\n----------------------------------------------------------\nPurchase Code: &lt;?=$targetPurchaseCode;?&gt;\nIs Valid License: &lt;?=$isValidTargetLicense ? 'Yes' : 'No';?&gt;\nBuyer Username: &lt;?=$targetLicenseBuyer;?&gt;\nLicense Type: &lt;?=$targetLicenseType;?&gt;\nPurchased At: &lt;?=$targetLicensePurchasedAt;?&gt;\nSupported Until: &lt;?=$targetLicenseSupportedUntil;?&gt;\nSupport Status: &lt;?=$targetLicenseSupportActive == 1 ? \"Supported\" : \"Support Expired\";?&gt;\n\n2. Details About Target Envato User - &lt;?=$targetUsername;?&gt;\n----------------------------------------------------------\n&lt;?=$targetUsername;?&gt; is located in &lt;?=$targetUserCity;?&gt;, &lt;?=$targetUserCountry;?&gt;.\nHe sold his items &lt;?=$targetUserSales;?&gt; times and has &lt;?=$targetUserFollowers;?&gt; followers on Envato.\n\n3. Status of Purchased Plugin ID - &lt;?=$targetPluginId;?&gt;\n----------------------------------------------------------\nPlugin Name: &lt;?=$nameOfTargetPluginId;?&gt;\nPlugin Update Available: &lt;?=$pluginUpdateAvailable ? 'Yes' : 'No';?&gt;\nInstalled Plugin Version: &lt;?=$installedPluginVersion;?&gt;\nAvailable Plugin Version: &lt;?=$availablePluginVersion;?&gt;\nPlugin Update Download URL:\n&lt;a href=\"&lt;?=$pluginUpdateDownloadUrl;?&gt;\" target=\"_blank\" title=\"Download newest version\"&gt;Download newest version&lt;/a&gt;\n\n4. Status of Purchased Theme ID - &lt;?=$targetThemeId;?&gt;:\n----------------------------------------------------------\nTheme Name: &lt;?=$nameOfTargetThemeId;?&gt;\nTheme Update Available: &lt;?=$themeUpdateAvailable ? 'Yes' : 'No';?&gt;\nInstalled Theme Version: &lt;?=$installedThemeVersion;?&gt;\nAvailable Theme Version: &lt;?=$availableThemeVersion;?&gt;\nTheme Update Download URL:\n&lt;a href=\"&lt;?=$themeUpdateDownloadUrl;?&gt;\" target=\"_blank\" title=\"Download newest version\"&gt;Download newest version&lt;/a&gt;\n\n5. Envato Item Id of Purchased Plugin\n----------------------------------------------------------\nSearched for Name: &lt;?=$targetPluginName;?&gt;\nSearched for Author: &lt;?=$targetPluginAuthor;?&gt;\nFound Plugin Id: &lt;?=$foundPluginId;?&gt;\n\n6. Envato Item Id of Purchased Theme\n----------------------------------------------------------\nSearched for Name: &lt;?=$targetThemeName;?&gt;\nSearched for Author: &lt;?=$targetThemeAuthor;?&gt;\nFound Theme Id: &lt;?=$foundThemeId;?&gt;\n</code></pre>\n<p>And the example input of the output above, it this:</p>\n<pre><code>$objToolkit = new EnvatoAPIManager($toolkitSettings);\n\n// Details about you\n$purchasedPlugins = $objToolkit-&gt;getPurchasedPluginsWithDetails();\n$plugins = array();\nforeach($purchasedPlugins AS $pluginId =&gt; $purchasedPlugin)\n{\n    $purchasedPlugin['licenses'] = $objToolkit-&gt;getLicensesByItemId($pluginId);\n    $plugins[$pluginId] = $purchasedPlugin;\n}\n\n$purchasedThemes = $objToolkit-&gt;getPurchasedThemesWithDetails();\n$themes = array();\nforeach($purchasedThemes AS $themeId =&gt; $purchasedTheme)\n{\n    $purchasedTheme['licenses'] = $objToolkit-&gt;getLicensesByItemId($themeId);\n    $themes[$themeId] = $purchasedTheme;\n}\n\n$authorDetails = $objToolkit-&gt;getUserDetails($sanitizedEnvatoUsername);\n// View vars\n$view-&gt;plugins = $plugins;\n$view-&gt;themes = $themes;\nif($authorDetails != FALSE)\n{\n    $view-&gt;authorCity = $authorDetails['city'];\n    $view-&gt;authorCountry = $authorDetails['country'];\n    $view-&gt;authorSales = $authorDetails['sales'];\n    $view-&gt;authorFollowers = $authorDetails['followers'];\n} else\n{\n    $view-&gt;authorCity = '';\n    $view-&gt;authorCountry = '';\n    $view-&gt;authorSales = 0;\n    $view-&gt;authorFollowers = 0;\n}\n\n// 1. Details About Target Purchase Code\n$targetLicenseDetails = $objToolkit-&gt;getLicenseDetails($sanitizedTargetPurchaseCode);\n// View vars\n$view-&gt;targetPurchaseCode = esc_html($sanitizedTargetPurchaseCode); // Ready for print\n$view-&gt;isValidTargetLicense = $objToolkit-&gt;isValidLicense($sanitizedTargetPurchaseCode);\n$view-&gt;targetLicenseBuyer = $targetLicenseDetails['buyer_username'];\n$view-&gt;targetLicense = $targetLicenseDetails['license'];\n$view-&gt;targetLicensePurchasedAt = $targetLicenseDetails['license_purchase_date'].' '.$targetLicenseDetails['license_purchase_time'];\n$view-&gt;targetLicenseSupportedUntil = $targetLicenseDetails['support_expiration_date'].' '.$targetLicenseDetails['support_expiration_time'];\n$view-&gt;targetLicenseSupportActive = $targetLicenseDetails['support_active'];\n\n// 2. Details About Target Envato User\n$targetUserDetails = $objToolkit-&gt;getUserDetails($sanitizedTargetUsername);\n// View vars\n$view-&gt;targetUsername = esc_html($sanitizedTargetUsername); // Ready for print\n$view-&gt;targetUserCity = $targetUserDetails['city'];\n$view-&gt;targetUserCountry = $targetUserDetails['country'];\n$view-&gt;targetUserSales = $targetUserDetails['sales'];\n$view-&gt;targetUserFollowers = $targetUserDetails['followers'];\n\n// 3. Status of Purchased Plugin ID\n$availablePluginVersion = $objToolkit-&gt;getAvailableVersion($sanitizedTargetPluginId);\n$pluginUpdateAvailable = version_compare($sanitizedInstalledPluginVersion, $availablePluginVersion, '&lt;');\n// View vars\n$view-&gt;targetPluginId = intval($sanitizedTargetPluginId); // Ready for print\n$view-&gt;installedPluginVersion = esc_html($sanitizedInstalledPluginVersion); // Ready for print\n$view-&gt;nameOfTargetPluginId = esc_html($objToolkit-&gt;getItemName($sanitizedTargetPluginId));\n$view-&gt;availablePluginVersion = $availablePluginVersion;\n$view-&gt;pluginUpdateAvailable = $pluginUpdateAvailable;\n$view-&gt;pluginUpdateDownloadUrl = $pluginUpdateAvailable ? $objToolkit-&gt;getDownloadUrlIfPurchased($sanitizedTargetPluginId) : '';\n\n// 4. Status of Purchased Theme ID\n$availableThemeVersion = $objToolkit-&gt;getAvailableVersion($sanitizedTargetThemeId);\n$themeUpdateAvailable = version_compare($sanitizedInstalledThemeVersion, $availableThemeVersion, '&lt;');\n// View vars\n$view-&gt;targetThemeId = intval($sanitizedTargetThemeId); // Ready for print\n$view-&gt;installedThemeVersion = esc_html($sanitizedInstalledThemeVersion); // Ready for print\n$view-&gt;nameOfTargetThemeId = esc_html($objToolkit-&gt;getItemName($sanitizedTargetThemeId));\n$view-&gt;availableThemeVersion = $availableThemeVersion;\n$view-&gt;themeUpdateAvailable = $themeUpdateAvailable;\n$view-&gt;themeUpdateDownloadUrl = $themeUpdateAvailable ? $objToolkit-&gt;getDownloadUrlIfPurchased($sanitizedTargetThemeId) : '';\n\n// 5. Envato Item Id of Purchased Plugin\n$view-&gt;targetPluginName = esc_html($sanitizedTargetPluginName); // Ready for print\n$view-&gt;targetPluginAuthor = esc_html($sanitizedTargetPluginAuthor); // Ready for print\n$view-&gt;foundPluginId = $objToolkit-&gt;getItemIdByPluginAndAuthorIfPurchased($sanitizedTargetPluginName, $sanitizedTargetPluginAuthor);\n\n// 6. Envato Item Id of Purchased Theme\n$view-&gt;targetThemeName = esc_html($sanitizedTargetThemeName); // Ready for print\n$view-&gt;targetThemeAuthor = esc_html($sanitizedTargetThemeAuthor); // Ready for print\n$view-&gt;foundThemeId = $objToolkit-&gt;getItemIdByThemeAndAuthorIfPurchased($sanitizedTargetThemeName, $sanitizedTargetThemeAuthor);\n</code></pre>\n",
    "download_link": "https://downloads.wordpress.org/plugin/toolkit-for-envato.zip",
    "upgrade_notice": {
        "1.4": "<ul>\n<li>Just drag and drop new plugin folder.</li>\n</ul>",
        "1.3": "<ul>\n<li>Just drag and drop new plugin folder.</li>\n</ul>",
        "1.2": "<ul>\n<li>Just drag and drop new plugin folder.</li>\n</ul>",
        "1.1": "<ul>\n<li>Just drag and drop new plugin folder.</li>\n</ul>",
        "1.0": "<ul>\n<li>Initial release!</li>\n</ul>"
    },
    "screenshots": [
        {
            "src": "https://ps.w.org/toolkit-for-envato/assets/screenshot-1.png?rev=1682947",
            "caption": "Envato Toolkit - Search input"
        },
        {
            "src": "https://ps.w.org/toolkit-for-envato/assets/screenshot-2.png?rev=1690096",
            "caption": "Envato Toolkit - Search results"
        }
    ],
    "tags": {
        "api": "api",
        "envato": "envato",
        "license": "license",
        "purchase-validator": "purchase validator",
        "update-checker": "update checker"
    },
    "stable_tag": "trunk",
    "versions": [],
    "business_model": false,
    "repository_url": "",
    "commercial_support_url": "",
    "donate_link": "https://profiles.wordpress.org/KestutisIT",
    "banners": {
        "low": "https://ps.w.org/toolkit-for-envato/assets/banner-772x250.png?rev=1682947",
        "high": "https://ps.w.org/toolkit-for-envato/assets/banner-1544x500.png?rev=1682947"
    },
    "icons": {
        "1x": "https://ps.w.org/toolkit-for-envato/assets/icon-128x128.png?rev=1692171",
        "2x": "https://ps.w.org/toolkit-for-envato/assets/icon-256x256.png?rev=1692171"
    },
    "blocks": [],
    "block_assets": [],
    "author_block_count": 0,
    "author_block_rating": 56,
    "blueprints": [],
    "preview_link": "",
    "language_packs": []
}